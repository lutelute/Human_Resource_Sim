<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äººæè‚²æˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ v1</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .title {
            font-size: 2.5em;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2em;
            color: #7f8c8d;
            margin-bottom: 20px;
        }
        
        .year-display {
            font-size: 1.5em;
            color: #2c3e50;
            margin: 20px 0;
            text-align: center;
        }
        
        .budget-display {
            font-size: 1.2em;
            color: #27ae60;
            margin: 10px 0;
            text-align: center;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e9ecef;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .stat-label {
            color: #7f8c8d;
            margin-top: 5px;
            font-size: 0.9em;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }
        
        .control-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }
        
        .control-section h3 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .sector-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border: 2px solid #e9ecef;
        }
        
        .sector-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .sector-icon {
            font-size: 1.5em;
            margin-right: 10px;
        }
        
        .sector-name {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .sector-description {
            color: #7f8c8d;
            font-size: 0.9em;
            margin: 5px 0 15px 0;
        }
        
        .slider-container {
            margin: 10px 0;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            color: #2c3e50;
            font-weight: 500;
        }
        
        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e9ecef;
            outline: none;
            -webkit-appearance: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
        }
        
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            border: none;
        }
        
        .chart-container {
            margin: 40px 0;
            height: 500px;
            position: relative;
            background: white;
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #e9ecef;
        }
        
        .buttons {
            text-align: center;
            margin: 30px 0;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
            font-size: 1em;
            font-weight: 500;
            transition: background 0.3s ease;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        
        .auto-button {
            background: #27ae60;
        }
        
        .auto-button:hover {
            background: #229954;
        }
        
        .auto-button.running {
            background: #e74c3c;
        }
        
        .auto-button.running:hover {
            background: #c0392b;
        }
        
        .line-chart-container {
            margin: 40px 0;
            height: 400px;
            position: relative;
            background: white;
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #e9ecef;
        }
        
        .achievement-display {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }
        
        .achievement-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #27ae60;
        }
        
        .key-person-risks {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }
        
        .risk-item {
            display: inline-block;
            margin: 5px;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
        }
        
        .risk-high {
            background: #ffebee;
            color: #c62828;
            border: 1px solid #ef5350;
        }
        
        .risk-medium {
            background: #fff3e0;
            color: #ef6c00;
            border: 1px solid #ff9800;
        }
        
        .risk-low {
            background: #e8f5e8;
            color: #2e7d32;
            border: 1px solid #4caf50;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">ğŸŒ å›½å®¶äººæè‚²æˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
            <p class="subtitle">Human Capital Development Optimization Game</p>
            <p>é™ã‚‰ã‚ŒãŸè³‡æºã®ä¸­ã§ã€å›½åŠ›ã‚’æœ€å¤§åŒ–ã™ã‚‹äººæè‚²æˆæˆ¦ç•¥ã‚’æ¢ç´¢</p>
        </div>
        
        <div class="year-display" id="yearDisplay">å¹´åº¦: 0å¹´ç›®</div>
        <div class="budget-display" id="budgetDisplay">äºˆç®—: Â¥1,000å„„å††</div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="totalScore">63</div>
                <div class="stat-label">ç·åˆå›½åŠ›ã‚¹ã‚³ã‚¢</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="minScore">45</div>
                <div class="stat-label">æœ€å¼±è»¸ã‚¹ã‚³ã‚¢</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="avgScore">62</div>
                <div class="stat-label">å¹³å‡ã‚¹ã‚³ã‚¢</div>
            </div>
            <div class="stat-card achievement-display">
                <div class="achievement-value" id="achievementScore">75.2%</div>
                <div class="stat-label">ç›®æ¨™é”æˆåº¦</div>
            </div>
        </div>

        <div class="controls">
            <div class="control-section">
                <h3>ğŸ’° æŠ•è³‡é…åˆ†</h3>
                
                <div class="sector-card">
                    <div class="sector-header">
                        <span class="sector-icon">ğŸ“</span>
                        <span class="sector-name">å¤§å­¦ãƒ»ç ”ç©¶æ©Ÿé–¢</span>
                    </div>
                    <div class="sector-description">åŸºç¤ç ”ç©¶ãƒ»äººæè‚²æˆã®åœŸå°</div>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>æŠ•è³‡å‰²åˆ</span>
                            <span id="uniValue">30%</span>
                        </div>
                        <input type="range" class="slider" id="uniSlider" min="0" max="100" value="30">
                    </div>
                </div>
                
                <div class="sector-card">
                    <div class="sector-header">
                        <span class="sector-icon">ğŸ­</span>
                        <span class="sector-name">ç”£æ¥­ç•Œ</span>
                    </div>
                    <div class="sector-description">çµŒé¨“çš„æŠ€è¡“ãƒ»å®Ÿè·µçŸ¥ã®è“„ç©</div>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>æŠ•è³‡å‰²åˆ</span>
                            <span id="indValue">35%</span>
                        </div>
                        <input type="range" class="slider" id="indSlider" min="0" max="100" value="35">
                    </div>
                </div>
                
                <div class="sector-card">
                    <div class="sector-header">
                        <span class="sector-icon">ğŸ›ï¸</span>
                        <span class="sector-name">æ”¿åºœãƒ»æ”¿ç­–</span>
                    </div>
                    <div class="sector-description">æŠ•è³‡é…åˆ†ãƒ»åˆ¶åº¦è¨­è¨ˆ</div>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>æŠ•è³‡å‰²åˆ</span>
                            <span id="govValue">15%</span>
                        </div>
                        <input type="range" class="slider" id="govSlider" min="0" max="100" value="15">
                    </div>
                </div>
                
                <div class="sector-card">
                    <div class="sector-header">
                        <span class="sector-icon">ğŸ”¬</span>
                        <span class="sector-name">å¤–éƒ¨ç ”ç©¶è€…</span>
                    </div>
                    <div class="sector-description">é«˜åº¦å°‚é–€çŸ¥è­˜ãƒ»å›½éš›é€£æº</div>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>æŠ•è³‡å‰²åˆ</span>
                            <span id="resValue">20%</span>
                        </div>
                        <input type="range" class="slider" id="resSlider" min="0" max="100" value="20">
                    </div>
                </div>
            </div>
            
            <div class="control-section">
                <h3>ğŸ‘¥ äººæé…åˆ†ï¼ˆå¤§å­¦ã‹ã‚‰ã®è¼©å‡ºå…ˆï¼‰</h3>
                
                <div class="slider-container">
                    <div class="slider-label">
                        <span>ğŸ­ ç”£æ¥­ç•Œã¸ã®é…åˆ†</span>
                        <span id="toIndValue">50%</span>
                    </div>
                    <input type="range" class="slider" id="toIndSlider" min="0" max="100" value="50">
                </div>
                
                <div class="slider-container">
                    <div class="slider-label">
                        <span>ğŸ›ï¸ æ”¿åºœã¸ã®é…åˆ†</span>
                        <span id="toGovValue">20%</span>
                    </div>
                    <input type="range" class="slider" id="toGovSlider" min="0" max="100" value="20">
                </div>
                
                <div class="slider-container">
                    <div class="slider-label">
                        <span>ğŸ”¬ ç ”ç©¶æ©Ÿé–¢ã¸ã®é…åˆ†</span>
                        <span id="toResValue">30%</span>
                    </div>
                    <input type="range" class="slider" id="toResSlider" min="0" max="100" value="30">
                </div>
            </div>
        </div>

        <div class="buttons">
            <button onclick="simulateYear()">1å¹´é€²ã‚ã‚‹</button>
            <button onclick="simulate5Years()">5å¹´é€²ã‚ã‚‹</button>
            <button onclick="toggleAutoSimulation()" class="auto-button" id="autoButton">è‡ªå‹•å®Ÿè¡Œ</button>
            <button onclick="resetSimulation()">ãƒªã‚»ãƒƒãƒˆ</button>
        </div>

        <div class="chart-container">
            <canvas id="radarChart"></canvas>
        </div>

        <div class="line-chart-container">
            <canvas id="lineChart"></canvas>
        </div>

        <div class="key-person-risks" id="keyPersonRisks">
            <h4>ğŸ“Š ã‚­ãƒ¼ãƒ‘ãƒ¼ã‚½ãƒ³ä¾å­˜ãƒªã‚¹ã‚¯</h4>
            <div id="riskItems"></div>
        </div>
    </div>

    <script>
        // èƒ½åŠ›è»¸ã®å®šç¾©ï¼ˆ12è»¸ï¼‰
        const CAPABILITY_AXES = [
            { key: 'basicScience', name: 'åŸºç¤ç§‘å­¦', color: '#8884d8' },
            { key: 'appliedTech', name: 'å¿œç”¨æŠ€è¡“', color: '#82ca9d' },
            { key: 'digitalAI', name: 'ãƒ‡ã‚¸ã‚¿ãƒ«ãƒ»AI', color: '#ffc658' },
            { key: 'manufacturing', name: 'è£½é€ ãƒ»ã‚‚ã®ã¥ãã‚Š', color: '#ff7300' },
            { key: 'finance', name: 'é‡‘èãƒ»çµŒæ¸ˆ', color: '#00C49F' },
            { key: 'healthcare', name: 'åŒ»ç™‚ãƒ»ãƒ˜ãƒ«ã‚¹ã‚±ã‚¢', color: '#FFBB28' },
            { key: 'energy', name: 'ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ»ç’°å¢ƒ', color: '#FF8042' },
            { key: 'globalCompete', name: 'å›½éš›ç«¶äº‰åŠ›', color: '#0088FE' },
            { key: 'innovation', name: 'ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³', color: '#00C49F' },
            { key: 'education', name: 'æ•™è‚²åŸºç›¤', color: '#FFBB28' },
            { key: 'policyMaking', name: 'æ”¿ç­–ç«‹æ¡ˆ', color: '#FF8042' },
            { key: 'implementation', name: 'ç¤¾ä¼šå®Ÿè£…åŠ›', color: '#8884d8' },
        ];

        // åˆæœŸå›½åŠ›çŠ¶æ…‹
        const initialNationalCapability = {
            basicScience: 70,
            appliedTech: 65,
            digitalAI: 55,
            manufacturing: 75,
            finance: 60,
            healthcare: 70,
            energy: 50,
            globalCompete: 45,
            innovation: 50,
            education: 65,
            policyMaking: 55,
            implementation: 60,
        };

        // ç›®æ¨™ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
        const targetCapability = {
            basicScience: 85,
            appliedTech: 85,
            digitalAI: 90,
            manufacturing: 80,
            finance: 75,
            healthcare: 85,
            energy: 80,
            globalCompete: 75,
            innovation: 85,
            education: 80,
            policyMaking: 70,
            implementation: 80,
        };

        // çŠ¶æ…‹ç®¡ç†
        let year = 0;
        let budget = 1000;
        let capability = {...initialNationalCapability};
        let history = [{year: 0, ...initialNationalCapability, totalScore: calculateScore(initialNationalCapability)}];
        let isSimulating = false;
        let autoSimulationInterval = null;

        // æŠ•è³‡é…åˆ†
        let investments = {
            university: 30,
            industry: 35,
            government: 15,
            research: 20,
        };

        // äººæé…åˆ†ï¼ˆå¤§å­¦ã‹ã‚‰ã®è¼©å‡ºå…ˆï¼‰
        let talentAllocation = {
            toIndustry: 50,
            toGovernment: 20,
            toResearch: 30,
        };

        // ã‚­ãƒ¼ãƒ‘ãƒ¼ã‚½ãƒ³ä¾å­˜åº¦
        let keyPersonRisk = {};

        let radarChart = null;
        let lineChart = null;

        // ã‚¹ã‚³ã‚¢è¨ˆç®—
        function calculateScore(cap) {
            const values = Object.values(cap);
            const avg = values.reduce((a, b) => a + b, 0) / values.length;
            const min = Math.min(...values);
            return Math.round(avg * 0.6 + min * 0.4);
        }

        // ç›®æ¨™é”æˆåº¦è¨ˆç®—ï¼ˆã‚³ã‚µã‚¤ãƒ³é¡ä¼¼åº¦ï¼‰
        function calculateAchievement(cap) {
            let dotProduct = 0;
            let normCap = 0;
            let normTarget = 0;
            
            CAPABILITY_AXES.forEach(axis => {
                dotProduct += cap[axis.key] * targetCapability[axis.key];
                normCap += cap[axis.key] ** 2;
                normTarget += targetCapability[axis.key] ** 2;
            });
            
            return (dotProduct / (Math.sqrt(normCap) * Math.sqrt(normTarget)) * 100).toFixed(1);
        }

        // 1å¹´åˆ†ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        function simulateYear() {
            const newCap = {...capability};
            
            // å¤§å­¦æŠ•è³‡åŠ¹æœï¼ˆåŸºç¤èƒ½åŠ›å‘ä¸Šï¼‰
            const uniEffect = investments.university / 100;
            newCap.basicScience += uniEffect * 3 * (1 + talentAllocation.toResearch / 100);
            newCap.education += uniEffect * 2;
            newCap.innovation += uniEffect * 1.5;
            
            // ç”£æ¥­ç•ŒæŠ•è³‡åŠ¹æœï¼ˆå®Ÿè·µèƒ½åŠ›å‘ä¸Šï¼‰
            const indEffect = investments.industry / 100;
            newCap.appliedTech += indEffect * 3;
            newCap.manufacturing += indEffect * 2.5;
            newCap.digitalAI += indEffect * 2;
            newCap.implementation += indEffect * 2;
            
            // æ”¿åºœæŠ•è³‡åŠ¹æœï¼ˆæ”¿ç­–ãƒ»èª¿æ•´èƒ½åŠ›ï¼‰
            const govEffect = investments.government / 100;
            newCap.policyMaking += govEffect * 2;
            newCap.finance += govEffect * 1.5;
            
            // ç ”ç©¶æŠ•è³‡åŠ¹æœï¼ˆå…ˆç«¯ãƒ»å›½éš›èƒ½åŠ›ï¼‰
            const resEffect = investments.research / 100;
            newCap.globalCompete += resEffect * 3;
            newCap.healthcare += resEffect * 2;
            newCap.energy += resEffect * 2;
            
            // äººæé…åˆ†ã®ç›¸äº’ä½œç”¨åŠ¹æœ
            const talentSynergy = (talentAllocation.toIndustry * talentAllocation.toResearch) / 10000;
            newCap.innovation += talentSynergy * 1.5;
            newCap.implementation += talentSynergy * 1;
            
            // é™³è…åŒ–ï¼ˆæ¯å¹´å°‘ã—ãšã¤æ¸›å°‘ï¼‰
            Object.keys(newCap).forEach(key => {
                newCap[key] = Math.max(0, Math.min(100, newCap[key] - 1 + Math.random() * 0.5));
            });
            
            // ã‚­ãƒ¼ãƒ‘ãƒ¼ã‚½ãƒ³ãƒªã‚¹ã‚¯è¨ˆç®—
            const newRisk = {};
            Object.keys(newCap).forEach(key => {
                newRisk[key] = newCap[key] > 80 ? 'high' : newCap[key] > 60 ? 'medium' : 'low';
            });
            keyPersonRisk = newRisk;
            
            capability = newCap;
            
            // äºˆç®—æ›´æ–°
            const income = calculateScore(capability) * 2;
            const totalInvestment = Object.values(investments).reduce((a, b) => a + b, 0);
            budget = Math.max(0, budget + income - totalInvestment * 3);
            
            year++;
            
            // å±¥æ­´æ›´æ–°
            history.push({
                year,
                ...capability,
                totalScore: calculateScore(capability)
            });
            
            updateUI();
        }

        // 5å¹´é€²ã‚ã‚‹
        function simulate5Years() {
            for (let i = 0; i < 5; i++) {
                simulateYear();
            }
        }

        // è‡ªå‹•ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ‡ã‚Šæ›¿ãˆ
        function toggleAutoSimulation() {
            if (isSimulating) {
                clearInterval(autoSimulationInterval);
                isSimulating = false;
                document.getElementById('autoButton').textContent = 'è‡ªå‹•å®Ÿè¡Œ';
                document.getElementById('autoButton').classList.remove('running');
            } else {
                isSimulating = true;
                document.getElementById('autoButton').textContent = 'åœæ­¢';
                document.getElementById('autoButton').classList.add('running');
                autoSimulationInterval = setInterval(() => {
                    if (year >= 50) {
                        toggleAutoSimulation();
                    } else {
                        simulateYear();
                    }
                }, 500);
            }
        }

        // ãƒªã‚»ãƒƒãƒˆ
        function resetSimulation() {
            if (isSimulating) {
                toggleAutoSimulation();
            }
            
            year = 0;
            budget = 1000;
            capability = {...initialNationalCapability};
            history = [{year: 0, ...initialNationalCapability, totalScore: calculateScore(initialNationalCapability)}];
            keyPersonRisk = {};
            
            updateUI();
        }

        // UIæ›´æ–°
        function updateUI() {
            // åŸºæœ¬æƒ…å ±æ›´æ–°
            document.getElementById('yearDisplay').textContent = `å¹´åº¦: ${year}å¹´ç›®`;
            document.getElementById('budgetDisplay').textContent = `äºˆç®—: Â¥${budget}å„„å††`;
            
            // çµ±è¨ˆæ›´æ–°
            const values = Object.values(capability);
            const avg = values.reduce((a, b) => a + b, 0) / values.length;
            const min = Math.min(...values);
            const total = calculateScore(capability);
            const achievement = calculateAchievement(capability);
            
            document.getElementById('totalScore').textContent = total;
            document.getElementById('minScore').textContent = min.toFixed(0);
            document.getElementById('avgScore').textContent = avg.toFixed(0);
            document.getElementById('achievementScore').textContent = achievement + '%';
            
            updateCharts();
            updateKeyPersonRisks();
        }

        // ãƒãƒ£ãƒ¼ãƒˆæ›´æ–°
        function updateCharts() {
            updateRadarChart();
            updateLineChart();
        }

        // ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆæ›´æ–°
        function updateRadarChart() {
            const ctx = document.getElementById('radarChart');
            if (radarChart) {
                radarChart.destroy();
            }

            const data = {
                labels: CAPABILITY_AXES.map(axis => axis.name),
                datasets: [{
                    label: 'ç¾åœ¨ã®å›½åŠ›',
                    data: CAPABILITY_AXES.map(axis => capability[axis.key]),
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    pointBackgroundColor: 'rgba(54, 162, 235, 1)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgba(54, 162, 235, 1)'
                }, {
                    label: 'ç›®æ¨™',
                    data: CAPABILITY_AXES.map(axis => targetCapability[axis.key]),
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    pointBackgroundColor: 'rgba(255, 99, 132, 1)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgba(255, 99, 132, 1)'
                }]
            };

            radarChart = new Chart(ctx, {
                type: 'radar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: '12è»¸å›½åŠ›ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ'
                        }
                    }
                }
            });
        }

        // ç·šã‚°ãƒ©ãƒ•æ›´æ–°
        function updateLineChart() {
            const ctx = document.getElementById('lineChart');
            if (lineChart) {
                lineChart.destroy();
            }

            const data = {
                labels: history.map(h => h.year),
                datasets: [{
                    label: 'ç·åˆã‚¹ã‚³ã‚¢',
                    data: history.map(h => h.totalScore),
                    borderColor: 'rgba(75, 192, 192, 1)',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    tension: 0.1
                }, {
                    label: 'æœ€å¼±è»¸',
                    data: history.map(h => Math.min(...CAPABILITY_AXES.map(axis => h[axis.key]))),
                    borderColor: 'rgba(255, 99, 132, 1)',
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    tension: 0.1
                }]
            };

            lineChart = new Chart(ctx, {
                type: 'line',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'å›½åŠ›æ¨ç§»'
                        }
                    }
                }
            });
        }

        // ã‚­ãƒ¼ãƒ‘ãƒ¼ã‚½ãƒ³ãƒªã‚¹ã‚¯è¡¨ç¤ºæ›´æ–°
        function updateKeyPersonRisks() {
            const container = document.getElementById('riskItems');
            container.innerHTML = '';
            
            CAPABILITY_AXES.forEach(axis => {
                const risk = keyPersonRisk[axis.key];
                if (risk) {
                    const item = document.createElement('span');
                    item.className = `risk-item risk-${risk}`;
                    item.textContent = `${axis.name}: ${risk.toUpperCase()}`;
                    container.appendChild(item);
                }
            });
        }

        // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
        function setupSliders() {
            // æŠ•è³‡é…åˆ†ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
            document.getElementById('uniSlider').addEventListener('input', (e) => {
                investments.university = parseInt(e.target.value);
                document.getElementById('uniValue').textContent = `${investments.university}%`;
            });

            document.getElementById('indSlider').addEventListener('input', (e) => {
                investments.industry = parseInt(e.target.value);
                document.getElementById('indValue').textContent = `${investments.industry}%`;
            });

            document.getElementById('govSlider').addEventListener('input', (e) => {
                investments.government = parseInt(e.target.value);
                document.getElementById('govValue').textContent = `${investments.government}%`;
            });

            document.getElementById('resSlider').addEventListener('input', (e) => {
                investments.research = parseInt(e.target.value);
                document.getElementById('resValue').textContent = `${investments.research}%`;
            });

            // äººæé…åˆ†ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
            document.getElementById('toIndSlider').addEventListener('input', (e) => {
                talentAllocation.toIndustry = parseInt(e.target.value);
                document.getElementById('toIndValue').textContent = `${talentAllocation.toIndustry}%`;
            });

            document.getElementById('toGovSlider').addEventListener('input', (e) => {
                talentAllocation.toGovernment = parseInt(e.target.value);
                document.getElementById('toGovValue').textContent = `${talentAllocation.toGovernment}%`;
            });

            document.getElementById('toResSlider').addEventListener('input', (e) => {
                talentAllocation.toResearch = parseInt(e.target.value);
                document.getElementById('toResValue').textContent = `${talentAllocation.toResearch}%`;
            });
        }

        // åˆæœŸåŒ–
        window.addEventListener('load', () => {
            setupSliders();
            updateUI();
        });
    </script>
</body>
</html>