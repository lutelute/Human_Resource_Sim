<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äººæè‚²æˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ v2</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .control-group {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }
        
        .control-group h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .slider {
            width: 100%;
            margin: 10px 0;
        }
        
        .chart-container {
            margin: 20px 0;
            height: 400px;
            position: relative;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: #f1f2f6;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .stat-label {
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        .year-display {
            text-align: center;
            font-size: 1.5em;
            margin: 20px 0;
            color: #2c3e50;
        }
        
        .individual-tracker {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .individual-list {
            max-height: 300px;
            overflow-y: auto;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .individual-card {
            background: white;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-size: 0.9em;
        }
        
        .individual-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .individual-sector {
            color: #7f8c8d;
            font-size: 0.8em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 style="text-align: center; color: #2c3e50;">ğŸŒ å›½å®¶äººæè‚²æˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ v2</h1>
        <p style="text-align: center; color: #7f8c8d;">å€‹äººãƒ¢ãƒ‡ãƒ«è¿½è·¡ãƒ»æŠ€è¡“ç¶™æ‰¿æ€§æŒ‡æ¨™</p>
        
        <div class="year-display" id="yearDisplay">
            å¹´åº¦: 0å¹´ç›®
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="totalScore">63</div>
                <div class="stat-label">ç·åˆå›½åŠ›ã‚¹ã‚³ã‚¢</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="individualCount">0</div>
                <div class="stat-label">äººæç·æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="industryCount">0</div>
                <div class="stat-label">ç”£æ¥­ç•Œäººæ</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="minScore">45</div>
                <div class="stat-label">æœ€å¼±è»¸ã‚¹ã‚³ã‚¢</div>
            </div>
        </div>

        <div class="controls">
            <div class="control-group">
                <h3>æŠ•è³‡é…åˆ†</h3>
                <div>
                    <label id="uniLabel">ğŸ“ å¤§å­¦æŠ•è³‡: 30%</label>
                    <input type="range" class="slider" id="uniSlider" min="0" max="100" value="30" />
                </div>
                <div>
                    <label id="indLabel">ğŸ­ ç”£æ¥­æŠ•è³‡: 35%</label>
                    <input type="range" class="slider" id="indSlider" min="0" max="100" value="35" />
                </div>
            </div>
            
            <div class="control-group">
                <h3>äººæé…åˆ†ï¼ˆå¤§å­¦ã‹ã‚‰ã®è¼©å‡ºå…ˆï¼‰</h3>
                <div>
                    <label id="toIndLabel">ğŸ­ ç”£æ¥­ç•Œ: 50%</label>
                    <input type="range" class="slider" id="toIndSlider" min="0" max="100" value="50" />
                </div>
                <div>
                    <label id="toGovLabel">ğŸ›ï¸ æ”¿åºœ: 20%</label>
                    <input type="range" class="slider" id="toGovSlider" min="0" max="100" value="20" />
                </div>
                <div>
                    <label id="toResLabel">ğŸ”¬ ç ”ç©¶æ©Ÿé–¢: 30%</label>
                    <input type="range" class="slider" id="toResSlider" min="0" max="100" value="30" />
                </div>
            </div>
        </div>

        <div style="text-align: center; margin: 20px 0;">
            <button onclick="simulateYear()">1å¹´é€²ã‚ã‚‹</button>
            <button onclick="resetSimulation()">ãƒªã‚»ãƒƒãƒˆ</button>
        </div>

        <div class="chart-container">
            <canvas id="radarChart"></canvas>
        </div>

        <div class="individual-tracker">
            <h3>äººæè¿½è·¡ (æœ€æ–°50å)</h3>
            <div class="individual-list" id="individualList">
                <!-- å€‹äººãƒ‡ãƒ¼ã‚¿ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
            </div>
        </div>
    </div>

    <script>
        // èƒ½åŠ›è»¸ã®å®šç¾©
        const CAPABILITY_AXES = [
            { key: 'basicScience', name: 'åŸºç¤ç§‘å­¦' },
            { key: 'appliedTech', name: 'å¿œç”¨æŠ€è¡“' },
            { key: 'digitalAI', name: 'ãƒ‡ã‚¸ã‚¿ãƒ«ãƒ»AI' },
            { key: 'manufacturing', name: 'è£½é€ ãƒ»ã‚‚ã®ã¥ãã‚Š' },
            { key: 'finance', name: 'é‡‘èãƒ»çµŒæ¸ˆ' },
            { key: 'healthcare', name: 'åŒ»ç™‚ãƒ»ãƒ˜ãƒ«ã‚¹ã‚±ã‚¢' },
            { key: 'energy', name: 'ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ»ç’°å¢ƒ' },
            { key: 'globalCompete', name: 'å›½éš›ç«¶äº‰åŠ›' },
            { key: 'innovation', name: 'ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³' },
            { key: 'education', name: 'æ•™è‚²åŸºç›¤' },
            { key: 'policyMaking', name: 'æ”¿ç­–ç«‹æ¡ˆ' },
            { key: 'implementation', name: 'ç¤¾ä¼šå®Ÿè£…åŠ›' }
        ];

        const SECTOR_NAMES = {
            'university': 'å¤§å­¦',
            'industry': 'ç”£æ¥­ç•Œ',
            'government': 'æ”¿åºœ',
            'research': 'ç ”ç©¶æ©Ÿé–¢'
        };

        // åˆæœŸå›½åŠ›çŠ¶æ…‹
        const initialCapability = {
            basicScience: 70,
            appliedTech: 65,
            digitalAI: 55,
            manufacturing: 75,
            finance: 60,
            healthcare: 70,
            energy: 50,
            globalCompete: 45,
            innovation: 50,
            education: 65,
            policyMaking: 55,
            implementation: 60,
        };

        // ç¾åœ¨ã®çŠ¶æ…‹
        let year = 0;
        let capability = {...initialCapability};
        let investments = {
            university: 30,
            industry: 35,
            government: 15,
            research: 20,
        };
        let talentAllocation = {
            toIndustry: 50,
            toGovernment: 20,
            toResearch: 30,
        };
        let individuals = [];
        let chart = null;

        // å€‹äººãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
        function generateIndividual(id, sector) {
            const strengths = [];
            const numStrengths = Math.floor(Math.random() * 3) + 1;
            
            for (let i = 0; i < numStrengths; i++) {
                const randomAxis = CAPABILITY_AXES[Math.floor(Math.random() * CAPABILITY_AXES.length)];
                if (!strengths.includes(randomAxis.key)) {
                    strengths.push(randomAxis.key);
                }
            }
            
            return {
                id,
                name: `äººæ${Math.floor(id)}`,
                sector,
                strengths,
                yearsInSector: 0,
                totalContribution: 0
            };
        }

        // ã‚¹ã‚³ã‚¢è¨ˆç®—
        function calculateScore(cap) {
            const values = Object.values(cap);
            const avg = values.reduce((a, b) => a + b, 0) / values.length;
            const min = Math.min(...values);
            return Math.round(avg * 0.6 + min * 0.4);
        }

        // çµ±è¨ˆæ›´æ–°
        function updateStats() {
            const values = Object.values(capability);
            const min = Math.min(...values);
            const total = calculateScore(capability);
            const industryCount = individuals.filter(p => p.sector === 'industry').length;
            
            document.getElementById('totalScore').textContent = total;
            document.getElementById('individualCount').textContent = individuals.length;
            document.getElementById('industryCount').textContent = industryCount;
            document.getElementById('minScore').textContent = min.toFixed(0);
            document.getElementById('yearDisplay').textContent = `å¹´åº¦: ${year}å¹´ç›®`;
        }

        // å€‹äººãƒªã‚¹ãƒˆæ›´æ–°
        function updateIndividualList() {
            const listElement = document.getElementById('individualList');
            const latest50 = individuals.slice(-50);
            
            listElement.innerHTML = '';
            latest50.forEach(person => {
                const card = document.createElement('div');
                card.className = 'individual-card';
                
                const strengthNames = person.strengths.slice(0, 2).map(s => {
                    const axis = CAPABILITY_AXES.find(a => a.key === s);
                    return axis ? axis.name.slice(0, 4) : '';
                }).join(', ');
                
                card.innerHTML = `
                    <div class="individual-name">${person.name}</div>
                    <div class="individual-sector">${SECTOR_NAMES[person.sector]} (${person.yearsInSector}å¹´ç›®)</div>
                    <div style="font-size: 0.7em; margin-top: 3px;">
                        å°‚é–€: ${strengthNames}
                    </div>
                `;
                
                listElement.appendChild(card);
            });
        }

        // ãƒãƒ£ãƒ¼ãƒˆæ›´æ–°
        function updateChart() {
            const ctx = document.getElementById('radarChart');
            if (chart) {
                chart.destroy();
            }

            const data = {
                labels: CAPABILITY_AXES.map(axis => axis.name),
                datasets: [{
                    label: 'ç¾åœ¨ã®å›½åŠ›',
                    data: CAPABILITY_AXES.map(axis => capability[axis.key]),
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    pointBackgroundColor: 'rgba(54, 162, 235, 1)',
                }]
            };

            chart = new Chart(ctx, {
                type: 'radar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20
                            }
                        }
                    }
                }
            });
        }

        // 1å¹´åˆ†ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        function simulateYear() {
            // å¤§å­¦æŠ•è³‡åŠ¹æœ
            const uniEffect = investments.university / 100;
            capability.basicScience += uniEffect * 3;
            capability.education += uniEffect * 2;
            capability.innovation += uniEffect * 1.5;
            
            // ç”£æ¥­ç•ŒæŠ•è³‡åŠ¹æœ
            const indEffect = investments.industry / 100;
            capability.appliedTech += indEffect * 3;
            capability.manufacturing += indEffect * 2.5;
            capability.digitalAI += indEffect * 2;
            capability.implementation += indEffect * 2;
            
            // æ”¿åºœæŠ•è³‡åŠ¹æœ
            const govEffect = investments.government / 100;
            capability.policyMaking += govEffect * 3;
            capability.finance += govEffect * 2;
            
            // ç ”ç©¶æŠ•è³‡åŠ¹æœ
            const resEffect = investments.research / 100;
            capability.globalCompete += resEffect * 3;
            capability.healthcare += resEffect * 2;
            capability.energy += resEffect * 2;
            
            // å€‹äººã‹ã‚‰ã®è²¢çŒ®åŠ¹æœ
            individuals.forEach(person => {
                person.strengths.forEach(strength => {
                    capability[strength] += 0.5 * (person.yearsInSector + 1) / 10;
                });
            });
            
            // ä¸Šé™ã‚’100ã«åˆ¶é™
            Object.keys(capability).forEach(key => {
                capability[key] = Math.min(100, capability[key]);
            });
            
            // æ—¢å­˜äººæã®å¹´æ•°å¢—åŠ 
            individuals = individuals.map(person => ({
                ...person,
                yearsInSector: person.yearsInSector + 1
            }));
            
            // æ–°è¦äººæè¿½åŠ 
            const newGraduates = Math.floor((investments.university / 10) * 2);
            for (let i = 0; i < newGraduates; i++) {
                let targetSector = 'industry';
                const rand = Math.random() * 100;
                if (rand < talentAllocation.toResearch) {
                    targetSector = 'research';
                } else if (rand < talentAllocation.toResearch + talentAllocation.toGovernment) {
                    targetSector = 'government';
                }
                
                individuals.push(generateIndividual(
                    Date.now() + i + Math.random() * 1000,
                    targetSector
                ));
            }
            
            // äººæ•°åˆ¶é™ï¼ˆæœ€æ–°1000äººã¾ã§ï¼‰
            if (individuals.length > 1000) {
                individuals = individuals.slice(-1000);
            }
            
            year++;
            updateStats();
            updateChart();
            updateIndividualList();
        }

        // ãƒªã‚»ãƒƒãƒˆ
        function resetSimulation() {
            year = 0;
            capability = {...initialCapability};
            individuals = [];
            updateStats();
            updateChart();
            updateIndividualList();
        }

        // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
        function setupSliders() {
            // æŠ•è³‡é…åˆ†ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
            document.getElementById('uniSlider').addEventListener('input', (e) => {
                investments.university = parseInt(e.target.value);
                document.getElementById('uniLabel').textContent = `ğŸ“ å¤§å­¦æŠ•è³‡: ${investments.university}%`;
            });

            document.getElementById('indSlider').addEventListener('input', (e) => {
                investments.industry = parseInt(e.target.value);
                document.getElementById('indLabel').textContent = `ğŸ­ ç”£æ¥­æŠ•è³‡: ${investments.industry}%`;
            });

            // äººæé…åˆ†ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
            document.getElementById('toIndSlider').addEventListener('input', (e) => {
                talentAllocation.toIndustry = parseInt(e.target.value);
                document.getElementById('toIndLabel').textContent = `ğŸ­ ç”£æ¥­ç•Œ: ${talentAllocation.toIndustry}%`;
            });

            document.getElementById('toGovSlider').addEventListener('input', (e) => {
                talentAllocation.toGovernment = parseInt(e.target.value);
                document.getElementById('toGovLabel').textContent = `ğŸ›ï¸ æ”¿åºœ: ${talentAllocation.toGovernment}%`;
            });

            document.getElementById('toResSlider').addEventListener('input', (e) => {
                talentAllocation.toResearch = parseInt(e.target.value);
                document.getElementById('toResLabel').textContent = `ğŸ”¬ ç ”ç©¶æ©Ÿé–¢: ${talentAllocation.toResearch}%`;
            });
        }

        // åˆæœŸåŒ–
        window.addEventListener('load', () => {
            setupSliders();
            updateStats();
            updateChart();
            updateIndividualList();
        });
    </script>
</body>
</html>